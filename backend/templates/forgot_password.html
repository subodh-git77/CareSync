{% extends "base.html" %}
{% block content %}

<!-- ðŸŒ FORGOT PASSWORD PAGE -->
<section class="min-h-screen flex items-center justify-center bg-animated-gradient py-16 px-4 overflow-hidden">

  <div class="w-full max-w-md bg-white/90 backdrop-blur-md shadow-2xl rounded-2xl p-8 border border-blue-100 animate-fade-slide-up">

    <!-- Header -->
    <div class="text-center mb-8 animate-fade-in">
      <div class="w-16 h-16 mx-auto bg-gradient-to-br from-blue-600 to-indigo-500 rounded-full flex items-center justify-center shadow-md transition-transform duration-300 hover:scale-110">
        <i data-lucide="key-round" class="w-8 h-8 text-white"></i>
      </div>
      <h2 class="mt-4 text-2xl font-bold text-blue-700">Forgot Password?</h2>
      <p class="text-gray-600 text-sm mt-2 max-w-sm mx-auto">
        Enter your registered email address â€” weâ€™ll send you a secure password reset link.
      </p>
    </div>

    <!-- Form -->
    <form method="POST" id="forgotForm" class="space-y-5">

      <!-- Email Input -->
      <div class="animate-fade-delay-1">
        <label for="email" class="block text-gray-700 font-medium mb-1 flex items-center">
          <i data-lucide="mail" class="w-4 h-4 mr-2 text-blue-600"></i> Email Address
        </label>
        <input type="email" id="email" name="email"
               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none transition duration-200"
               placeholder="you@example.com" required>
      </div>

      <!-- Submit Button -->
      <button type="submit"
              class="w-full py-3 bg-gradient-to-r from-blue-600 to-indigo-500 text-white font-semibold rounded-lg shadow-md 
                     hover:shadow-lg hover:scale-[1.03] transition-all duration-300 flex items-center justify-center animate-fade-delay-2">
        <i data-lucide="send" class="w-4 h-4 mr-2"></i> Send Reset Link
      </button>

      <!-- Back to Login -->
      <div class="text-center mt-5 animate-fade-delay-3">
        <a href="{{ url_for('patient.login_page') }}"
           class="inline-flex items-center justify-center gap-2 text-blue-700 hover:text-indigo-700 font-medium transition-colors duration-200">
          <i data-lucide="arrow-left" class="w-4 h-4"></i> Back to Login
        </a>
      </div>
    </form>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mt-6 animate-fade-in">
          {% for category, msg in messages %}
            <div class="p-3 rounded-lg text-center text-sm font-medium 
                        {% if category == 'success' %}bg-green-100 text-green-700
                        {% elif category == 'danger' %}bg-red-100 text-red-700
                        {% elif category == 'warning' %}bg-yellow-100 text-yellow-700
                        {% else %}bg-blue-100 text-blue-700{% endif %}">
              {{ msg }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <!-- Success Animation -->
    <div id="success-animation" class="hidden mt-6 text-center animate-fade-in">
      <div class="circle-loader mx-auto">
        <div class="checkmark draw"></div>
      </div>
      <p class="text-green-600 font-semibold mt-3">Email sent successfully! Redirecting...</p>
    </div>

    <!-- Footer -->
    <p class="text-center text-gray-500 text-sm mt-8 animate-fade-in">
      Â© {{ current_year or 2025 }} <span class="font-semibold text-blue-700">CareSync</span> â€” Forgot Password
    </p>

  </div>
</section>

<!-- ðŸŒˆ Animations and Background -->
<style>
/* === Animated Gradient Background === */
.bg-animated-gradient {
  background: linear-gradient(-45deg, #e3f2fd, #e8f5e9, #f1f8e9, #e0f7fa);
  background-size: 400% 400%;
  animation: gradientShift 12s ease infinite;
}
@keyframes gradientShift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* === Fade Animations === */
@keyframes fade-slide-up {
  from { opacity: 0; transform: translateY(40px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}
.animate-fade-slide-up { animation: fade-slide-up 0.8s ease-out; }
.animate-fade-in { animation: fade-in 1s ease-in-out; }
.animate-fade-delay-1 { animation: fade-in 1s ease-in-out 0.2s both; }
.animate-fade-delay-2 { animation: fade-in 1s ease-in-out 0.4s both; }
.animate-fade-delay-3 { animation: fade-in 1s ease-in-out 0.6s both; }

/* === Input Focus === */
input:focus {
  border-color: #3b82f6;
  box-shadow: 0 0 6px rgba(59,130,246,0.3);
}

/* === Success Animation === */
.circle-loader {
  border: 4px solid rgba(0,0,0,0.1);
  border-left-color: #22c55e;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
  position: relative;
}
@keyframes spin { 100% { transform: rotate(360deg); } }

.checkmark {
  display: none;
  position: absolute;
  top: 14px;
  left: 15px;
  width: 20px;
  height: 40px;
  border-right: 3px solid #22c55e;
  border-bottom: 3px solid #22c55e;
  transform: rotate(45deg);
  animation: check 0.8s ease forwards;
}
@keyframes check {
  from { height: 0; width: 0; }
  to { height: 24px; width: 12px; display: block; }
}
.hidden { display: none; }

/* === Responsive === */
@media (max-width: 768px) {
  .w-full.max-w-md { padding: 2rem; }
  h2 { font-size: 1.6rem; }
  input { font-size: 0.95rem; }
}
@media (max-width: 480px) {
  h2 { font-size: 1.4rem; }
  input { font-size: 0.9rem; }
}
</style>

<!-- âœ… Lucide + Success Redirect Script -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  lucide.createIcons();

  const successAnimation = document.getElementById("success-animation");
  const infoAlerts = document.querySelectorAll(".alert.info");

  if (infoAlerts.length > 0) {
    successAnimation.classList.remove("hidden");
    setTimeout(() => {
      window.location.href = "{{ url_for('patient.login_page') }}";
    }, 3000);
  }
});
</script>

{% endblock %}
